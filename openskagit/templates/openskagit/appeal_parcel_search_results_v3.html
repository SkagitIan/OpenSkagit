{% load humanize %}
{% if query_too_short %}
  <div style="text-align: center; padding: var(--space-8) var(--space-4); color: var(--gray-500);">
    <svg style="width: 3rem; height: 3rem; margin: 0 auto var(--space-4); color: var(--gray-400);" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="11" cy="11" r="8"></circle>
      <path d="m21 21-4.35-4.35"></path>
    </svg>
    <div style="font-size: 0.9375rem;">Enter at least {{ min_search_length|default:3 }} characters to search</div>
  </div>
{% elif query %}
  {% if results %}
    {% for parcel in results %}
      {% with sale_price=parcel.sale_price sale_date=parcel.sale_date %}
        <a class="autocomplete-result"
           href="{% url 'appeal-result' parcel.parcel_number %}"
           data-address="{{ parcel.address|default:'Address unavailable'|escape }}"
           data-parcel="{{ parcel.parcel_number|escape }}"
           data-details="{% if sale_price and sale_date %}Last sold for ${{ sale_price|floatformat:0|intcomma }} on {{ sale_date|date:'M j, Y' %}{% elif sale_price %}Last sold for ${{ sale_price|floatformat:0|intcomma }}{% elif sale_date %}Last recorded sale {{ sale_date|date:'M j, Y' }}{% endif %}">
          <div class="result-address">{{ parcel.address|default:"Address unavailable" }}</div>
          <div class="result-parcel">Parcel {{ parcel.parcel_number }}</div>
          {% if sale_price or sale_date %}
            <div class="result-sale-info">
              {% if sale_price %}Last sale May 29, 2025{% if sale_date %} on {{ sale_date|date:"M j, Y" }}{% endif %}{% elif sale_date %}Last sale {{ sale_date|date:"M j, Y" }}{% endif %}
            </div>
          {% endif %}
          <div class="result-cta">
            Select to continue â†’ Jump directly to Step 2
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="5" y1="12" x2="19" y2="12"></line>
              <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
          </div>
        </a>
      {% endwith %}
    {% endfor %}
  {% else %}
    <div style="text-align: center; padding: var(--space-8) var(--space-4); color: var(--gray-500);">
      <svg style="width: 3rem; height: 3rem; margin: 0 auto var(--space-4); color: var(--gray-400);" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
      <div style="font-size: 0.9375rem;">No properties found for "{{ query }}". Try a different address or parcel number.</div>
    </div>
  {% endif %}
{% else %}
  <div style="text-align: center; padding: var(--space-8) var(--space-4); color: var(--gray-500);">
    <svg style="width: 3rem; height: 3rem; margin: 0 auto var(--space-4); color: var(--gray-400);" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="11" cy="11" r="8"></circle>
      <path d="m21 21-4.35-4.35"></path>
    </svg>
    <div style="font-size: 0.9375rem;">Start typing to find your property...</div>
  </div>
{% endif %}
